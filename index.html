<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Truck Load Planner</title>
<link rel="stylesheet" href="css/style.css">
<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.164.1/build/three.module.js",
    "three/addons/": "https://unpkg.com/three@0.164.1/examples/jsm/"
  }
}
</script>
</head>
<body>
<div id="app">
  <!-- Header -->
  <div id="header">
    <h1><span>Truck</span> Load Planner</h1>
    <div class="toolbar">
      <label>Truck:</label>
      <select id="truck-select"></select>
      <label>Config:</label>
      <select id="block-select"></select>
      <label>Sheet:</label>
      <input type="text" id="sheet-url" placeholder="Google Sheet URL or ID">
      <button id="btn-fetch-sheet" class="accent">Fetch Sheet</button>
      <button id="btn-perspective" title="Toggle perspective / orthographic">Perspective</button>
      <button id="btn-reset" title="Reset camera">Reset</button>
      <button id="btn-top" title="Top-down view">Top</button>
      <button id="btn-front" title="Front view (door side)">Front</button>
      <button id="btn-side" title="Side view">Side</button>
    </div>
  </div>

  <!-- 3D Canvas -->
  <div id="canvas-wrap">
    <div id="tooltip"></div>
    <div id="loading-overlay">
      <div class="loading-spinner"></div>
      <div class="loading-text" id="loading-text">Loading...</div>
    </div>
  </div>

  <!-- Sidebar -->
  <div id="sidebar">
    <!-- Department filter -->
    <div class="sidebar-section">
      <h3>Filter</h3>
      <select id="dept-filter" style="width:100%;background:var(--accent2);color:var(--text);border:1px solid var(--border);padding:5px 8px;border-radius:4px;font-size:12px">
        <option value="ALL">All Departments</option>
      </select>
    </div>

    <!-- Legend -->
    <div class="sidebar-section" id="legend-section">
      <h3>Department Legend</h3>
      <div id="legend-list"></div>
    </div>

    <!-- Detail Panel -->
    <div class="sidebar-section" id="detail-panel">
      <div class="detail-header">
        <h3 style="margin:0;padding:0;border:none">Case Details</h3>
        <button class="detail-close" id="detail-close">&times;</button>
      </div>
      <div id="detail-content"></div>
    </div>

    <!-- Case List -->
    <div class="sidebar-section" style="flex:1;display:flex;flex-direction:column;min-height:0">
      <h3>Cases (<span id="visible-count">0</span>)</h3>
      <div id="case-list"></div>
    </div>
  </div>

  <!-- Footer -->
  <div id="footer">
    <div class="stat">
      <span class="stat-label">Cases:</span>
      <span class="stat-value" id="stat-cases">0</span>
    </div>
    <div class="stat">
      <span class="stat-label">Walls:</span>
      <span class="stat-value" id="stat-walls">0</span>
    </div>
    <div class="stat">
      <span class="stat-label">Depth:</span>
      <span class="stat-value" id="stat-depth">0" / 624"</span>
    </div>
    <div class="stat">
      <span class="stat-label">Fill:</span>
      <div class="stat-bar"><div class="stat-bar-fill" id="stat-bar-fill" style="width:0%;background:var(--accent)"></div></div>
      <span class="stat-value" id="stat-fill">0%</span>
    </div>
    <div class="stat">
      <span class="stat-label">Volume:</span>
      <span class="stat-value" id="stat-volume">0%</span>
    </div>
    <span id="sheet-status"></span>
  </div>
</div>

<script type="module" src="js/app.js"></script>
</body>
</html>
